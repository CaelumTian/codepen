<!DOCTYPE html>
<html lang="en">
<head>
    <title>SIPC codepen</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <link rel="stylesheet" href="./lib/styles/css/reset.css">
    <link rel="stylesheet" href="./lib/styles/css/base.css">
    <link rel="stylesheet" href="./lib/styles/css/editor.css">
</head>
<body class="layout-side editor">
    <header class="main-header">
        <div class="title-area">
            <a href="/" class="logo">
                <img src="./lib/images/logo.png" alt="">
            </a>
            <div class="title-text">
                <h1 id="pen-title">
                    <!-- 这里a放置该帖子的title -->
                    <a href="#">
                        SIPC Code
                    </a>
                </h1>
                <!-- 这里天用户名 -->
                <div class="by">该代码片段 by 田光宇</div>
            </div>
        </div>
        <div class="header-chunk">
            <button class="btn btn-insert">
                <i class="icon icon-cloud"></i>保存
            </button>
            <button class="btn">
                <i class="icon icon-setting"></i>设置
            </button>
            <button class="btn">
                <i class="icon icon-resize"></i>切换视图
            </button>
            <button class="btn">
                登录
            </button>
            <button class="btn">
                注册
            </button>
        </div>
    </header>
    <div class="page-wrap">
        <div class="code-box box-direction">
            <div class="top-boxes editor-box" id="editor">
                <div id="box-html"></div>
                <div id="box-css"></div>
                <div id="box-js"></div>
            </div>
            <!-- 拖动条 -->
            <div id="resizer" class="resizer">
                <span></span>
                <div id="editor-width" class="editor-width">
                    210px
                </div>
            </div>
            <!-- 内容展示区 -->
            <div class="result-div result">

            </div>
        </div>
    </div>
    <footer class="site-footer">

    </footer>
    <script src="./lib/scripts/jquery-2.1.4.js"></script>
    <script>
        /*全局变量 sc */
        window.sc = {
            winSize : {
                "width" : window.innerWidth || $(document).innerWidth(),
                "height" : window.innerHeight || $(document).height()
            }
        };
        var bindResizer = (function() {
            var $resizer = $("#resizer"),           //拖动条
                    $showBlock = $("#editor-width"),
                    _resizeDirection,
                    _resizeRight = false,
                    _limitMin,
                    _limitMax,
                    _headerHeight,
                    ele_editor = document.getElementById("editor");           //编辑区
            var _minWidth = 216,
                    _minHeight = 125;

            function _init() {
                $resizer.off();                 //清除全部事件
                _resizeDirection = $("body").hasClass("layout-top") ? "horizonal" : "vertical";     //判断方向
                _resizeRight = $("body").hasClass("layout-right") ? true : false;                  //左右颠倒
                _headerHeight = $("header").height();
                if(_resizeDirection === "vertical") {
                    _limitMax = sc.winSize.width - $resizer.width();
                    _limitMin = _minWidth;
                }else {
                    _limitMax = sc.winSize.height - $resizer.height();
                    _limitMin = _minHeight;
                }

                _runAction();
            }

            function _runAction() {
                $resizer.on("mousedown", function(event) {
                    event.preventDefault();     //必须清除全部事件
                    $showBlock.css({
                        "opacity" : 1
                    });
                    if(_resizeDirection === "vertical") {
                        var eleWidth = ele_editor.style.width;
                        ele_editor.style.width = eleWidth < _limitMin ? _limitMin :  eleWidth;
                        ele_editor.style.width = eleWidth > _limitMax ? _limitMax : eleWidth;
                    }else {
                        var eleHeight = ele_editor.style.height;
                        ele_editor.style.height = eleHeight < _limitMin ? _limitMin :  eleHeight;
                        ele_editor.style.height= eleHeight > _limitMax ? _limitMax : eleHeight;
                    }
                    $(document).on("mousemove", resizeMove).on("mouseup", resizeEnd);    //添加两组事件
                })
            }

            function resizeMove(event) {
                event.preventDefault();
                if(_resizeDirection === "vertical") {
                    var dis = event.pageX;
                    if(_resizeRight) {
                        dis = sc.winSize.width - dis;
                    }
                    ele_editor.style.width = dis + "px";
                    $showBlock.text($(ele_editor).css("width"));
                }else {
                    var dis = event.pageY;
                    ele_editor.style.height = (dis - _headerHeight) + "px";
                    $showBlock.text($(ele_editor).css("height"));
                }
            }
            function resizeEnd(event) {
                $showBlock.css({
                    "opacity" : 0
                });
                $(document).off("mousemove", resizeMove).off("mouseup", resizeEnd);
            }

            //设置最小值
            function setMinValue(x, y) {
                _minWidth = x;
                _minHeight = y;
            }
            function _reset() {

            }
            return {
                init : _init,
                setMinValue : setMinValue
            }
        })();
        jQuery(document).ready(function($) {
            bindResizer.init();
        });

        /*浏览器窗口发生变化，重置所有内容*/
        $(window).on("resize", function() {
            console.log("重置");
            window.sc = {
                winSize : {
                    "width" : window.innerWidth || $(document).innerWidth(),
                    "height" : window.innerHeight || $(document).height()
                }
            };
            bindResizer.init();
        })
    </script>
</body>
</html>